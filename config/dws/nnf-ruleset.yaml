apiVersion: dws.cray.hpe.com/v1alpha1
kind: DWDirectiveRule
metadata:
  name: nnf
  annotations:
    helm.sh/hook: post-install
spec:
  - command: "jobdw"
    watchStates: proposal,setup,pre_run,post_run,teardown
    ruleDefs:
      - key: "type"
        type: "string"
        pattern: "^(raw|xfs|lustre)$"
        isRequired: true
        isValueRequired: true
      - key: "capacity"
        type: "string"
        pattern: "^\\d+(KiB|KB|MiB|MB|GiB|GB|TiB|TB)$"
        isRequired: true
        isValueRequired: true
      - key: "name"
        type: "string"
        pattern: "^([A-Za-z0-9\\-_]+)$"
        isRequired: true
        isValueRequired: true
      - key: "modifiers"
        type: "string"
        isRequired: false
        isValueRequired: true
      - key: "external_mgs"
        type: "string"
        pattern: "^([A-Za-z][A-Za-z0-9\\-_]+|[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+)@[A-Za-z][A-Za-z0-9]+$"
        isRequired: false
        isValueRequired: true
  - command: "create_persistent"
    watchStates: proposal,setup
    ruleDefs:
      - key: "type"
        type: "string"
        pattern: "^(raw|xfs|lustre)$"
        isRequired: true
        isValueRequired: true
      - key: "capacity"
        type: "string"
        pattern: "^\\d+(KiB|KB|MiB|MB|GiB|GB|TiB|TB)$"
        isRequired: true
        isValueRequired: true
      - key: "name"
        type: "string"
        pattern: "^([A-Za-z0-9\\-_]+)$"
        isRequired: true
        isValueRequired: true
      - key: "external_mgs"
        type: "string"
        pattern: "^([A-Za-z][A-Za-z0-9\\-_]+|[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+)@[A-Za-z][A-Za-z0-9]+$"
        isRequired: false
        isValueRequired: true
  - command: "copy_in"
    watchStates: data_in
    ruleDefs:
      - key: "source"
        type: "string"
        isRequired: true
        isValueRequired: true
      - key: "destination"
        type: "string"
        isRequired: true
        isValueRequired: true
  - command: "copy_out"
    watchStates: data_out
    ruleDefs:
      - key: "source"
        type: "string"
        isRequired: true
        isValueRequired: true
      - key: "destination"
        type: "string"
        isRequired: true
        isValueRequired: true
